"""
Fix Mislabeled Training Samples - Round 3 (Third Full Re-audit)
Every single sample was read and manually verified.
"""
import json
import os
import shutil
from datetime import datetime
from collections import Counter

DATA_PATH = "al_rased/data/labeledSamples/training_data.json"
BACKUP_DIR = "al_rased/data/labeledSamples/backups"

FIXES = [
    # ========================================================
    # HACKATHON posts mislabeled as HACKING â†’ NORMAL
    # These are students looking for hackathon teams
    # ========================================================
    (196, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø·Ø§Ù„Ø¨Ø© Ù‚Ø§Ù†ÙˆÙ† ØªØ¨Ø­Ø« Ø¹Ù† ÙØ±ÙŠÙ‚ Ù„Ù‡Ø§ÙƒØ«ÙˆÙ† Ø°ÙƒØ§Ø¡ Ø§Ù„Ù‚Ø¶Ø§Ø¡ - Ø·Ø¨ÙŠØ¹ÙŠ"),
    (1581, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ù‡Ø§ÙƒØ«ÙˆÙ† Ø¨Ø±Ø¹Ø§ÙŠÙ‡ Ø£Ù…ÙŠØ± Ø§Ù„Ø´Ø±Ù‚ÙŠØ© ÙŠØ­ØªØ§Ø¬ Ù…Ø¨Ø±Ù…Ø¬Ø© - Ø·Ø¨ÙŠØ¹ÙŠ"),
    (1582, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ØªØ®ØµØµ Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙŠØ¨Ø­Ø« Ø¹Ù† ØªÙŠÙ… Ù‡Ø§ÙƒØ«ÙˆÙ† - Ø·Ø¨ÙŠØ¹ÙŠ"),
    (1583, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø¨Ù†Ø§Øª Ù…Ø¨Ø±Ù…Ø¬Ø§Øª Ù„Ù‡Ø§ÙƒØ§Ø«ÙˆÙ† Ø¹Ø§Ù„Ù…ÙŠ Ø¨Ø§Ø³Ù… Ø¬Ø§Ù…Ø¹Ø© Ø§Ù„Ù…Ù„Ùƒ Ø®Ø§Ù„Ø¯ - Ø·Ø¨ÙŠØ¹ÙŠ"),
    (1591, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ÙŠØ¨Ø­Ø« Ø¹Ù† ÙØ±ÙŠÙ‚ Ù„Ù‡Ø§ÙƒØ«ÙˆÙ† Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ Ù…Ø³Ø§Ø± Ø§Ù„ØªÙ‚Ù†ÙŠØ© Ø§Ù„ØµØ­ÙŠØ© - Ø·Ø¨ÙŠØ¹ÙŠ"),
    (1592, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø§Ø­Ø¯ Ø¨ÙŠÙ‚Ø¯Ù… ÙƒÙØ±ÙŠÙ‚ Ø¹Ù„Ù‰ Ù‡Ø§ÙƒØ«ÙˆÙ† Ø¬Ø¯Ø© - Ø·Ø¨ÙŠØ¹ÙŠ"),
    (1595, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ù‡Ø§ÙƒØ«ÙˆÙ† Ø¨Ø§Ù„Ø±ÙŠØ§Ø¶ ÙŠØ­ØªØ§Ø¬ Ø´Ø®Øµ ÙŠØ³ÙˆÙŠ Ø¯Ø±Ø§Ø³Ø© Ø¬Ø¯ÙˆÙ‰ - Ø·Ø¨ÙŠØ¹ÙŠ"),
    (1596, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø¨Ù†Ø§Øª Ù…Ù‡ØªÙ…Ø© ØªØ´Ø§Ø±Ùƒ ÙÙŠ Ù‡Ø§ÙƒØ§Ø«ÙˆÙ† Ø°ÙƒØ§Ø¡ Ø§Ù„Ù‚Ø¶Ø§Ø¡ - Ø·Ø¨ÙŠØ¹ÙŠ"),
    (1787, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ù‡Ø§ÙƒØ§Ø«ÙˆÙ† Ø¨Ø±ÙˆØ¬ÙŠÙƒØªÙˆÙ† Ù„Ø§Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ ÙŠØ¨Ø­Ø« Ø¹Ù† Ø´Ø®Øµ - Ø·Ø¨ÙŠØ¹ÙŠ"),

    # ========================================================
    # MEDICAL FRAUD questions/discussions â†’ NORMAL or MEDICAL FRAUD (Ø·Ù„Ø¨)
    # These are students ASKING about sick leaves, not selling them
    # ========================================================
    (1147, "Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø·Ù„Ø¨)", ["Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø·Ù„Ø¨)"],
     "Ø§Ù„ÙŠ ÙŠØ¹Ø±Ù Ø§Ø­Ø¯ ÙŠØ¹Ø·ÙŠ Ø³ÙƒÙ„ÙŠÙ ÙŠØ±Ø³Ù„ÙŠ = Ø·Ù„Ø¨"),
    (1148, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø§ÙŠ Ø·Ø¨ÙŠØ¹ÙŠ ÙˆÙ†Ø¸Ø§Ù…ÙŠØ§ Ø§Ù„Ù…ÙØ±ÙˆØ¶ ÙŠØ§Ø®Ø° ØºÙŠØ§Ø¨ = Ù…Ø¬Ø±Ø¯ ØªØ¹Ù„ÙŠÙ‚"),
    (1149, "Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø·Ù„Ø¨)", ["Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø·Ù„Ø¨)"],
     "Ø§Ù„Ø­ÙŠÙ† Ø§Ù‚Ø¯Ø± Ø§Ø¬ÙŠØ¨ Ø³ÙƒÙ„ÙŠÙ ÙˆØ§Ø®ØªØ¨Ø± ÙØ§ÙŠÙ†Ù„ = Ø·Ù„Ø¨/Ø³Ø¤Ø§Ù„"),
    (1153, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø¨Ù†Ø§Øª Ø§Ø°Ø§ Ø¹Ù†Ø¯ÙŠ Ø³ÙƒÙ„ÙŠÙ Ù„Ù…ÙŠÙ† Ø§Ø¹Ø·ÙŠÙ‡ Ø¨Ø§Ù„Ø¬Ø§Ù…Ø¹Ù‡ = Ø³Ø¤Ø§Ù„ Ø¥Ø¯Ø§Ø±ÙŠ Ø·Ø¨ÙŠØ¹ÙŠ"),
    (1155, "Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø·Ù„Ø¨)", ["Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø·Ù„Ø¨)"],
     "Ù„Ùˆ Ø§Ø¬ÙŠØ¨ Ø³ÙƒÙ„ÙŠÙ ÙŠÙ‚Ø¨Ù„ÙˆÙ†Ù‡ = Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø¬Ø¯ÙˆÙ‰ Ø´Ø±Ø§Ø¡ Ø³ÙƒÙ„ÙŠÙ"),
    (1160, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø§Ø­Ø³Ø¨ Ù…Ø¹Ø¯Ù„Ùƒ Ù…Ù† ØªØ·Ø¨ÙŠÙ‚ mykku = Ù†ØµÙŠØ­Ø© Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ© Ø·Ø¨ÙŠØ¹ÙŠØ©"),
    (1161, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø­ØªÙ‰ Ø§Ù†Ø§ Ø·Ù„Ø¹Øª ØºÙŠØ± Ø¹Ù† Ø§Ù„ÙŠ Ø­Ø³Ø¨ØªÙ‡ Ø¨ØªØ·Ø¨ÙŠÙ‚ Ù…Ø¹Ø¯Ù„ÙŠ = ØªØ¹Ù„ÙŠÙ‚ Ø¹Ø§Ø¯ÙŠ"),
    (1163, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø£Ù†ØªÙ… Ø¢Ø®Ø± Ø¯ÙØ¹Ù‡ Ø·Ø¨ÙŠØ¹ÙŠ = ØªØ¹Ù„ÙŠÙ‚ Ø¹Ø§Ø¯ÙŠ"),
    (1166, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø¨Ù†Ø§Øª Ø¥Ø°Ø§ Ø¹Ù†Ø¯ÙŠ Ø³ÙƒÙ„ÙŠÙ ÙƒÙŠÙ Ø£Ø±Ø³Ù„Ù‡ Ù„Ù„Ø¯ÙƒØªÙˆØ±Ù‡ = Ø³Ø¤Ø§Ù„ Ø¥Ø¯Ø§Ø±ÙŠ Ø·Ø¨ÙŠØ¹ÙŠ"),
    (1169, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø³ÙƒÙ„ÙŠÙ Ø§Ù†Øª ÙˆÙ„Ø§ ÙˆØ´ = Ø³Ø¤Ø§Ù„ Ø¹Ø§Ø¯ÙŠ"),
    (1170, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø§Ù„Ø³Ù„Ø§Ù… Ø¹Ù„ÙŠÙƒÙ… Ø§Ø°Ø§ Ø¬Ø¨Øª Ø³ÙƒÙ„ÙŠÙ Ø§Ø¹Ø·ÙŠÙ‡ Ù…ÙŠÙ† = Ø³Ø¤Ø§Ù„ Ø¥Ø¯Ø§Ø±ÙŠ"),
    (1172, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø§Ù‡Ù… Ø´ÙŠ ÙŠÙ†Ø²Ù„ Ø¨ØµØ­ØªÙŠ = ØªØ¹Ù„ÙŠÙ‚ Ø¹Ø§Ø¯ÙŠ ÙÙŠ Ù…Ø­Ø§Ø¯Ø«Ø©"),
    (1177, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø§Ù„Ù„ÙŠ Ø¹Ù†Ø¯ Ù†ÙˆØ§Ù„ Ø§Ù„Ø´Ù‡Ø±ÙŠ ØªÙ‚Ø¨Ù„ Ø³ÙƒÙ„ÙŠÙ = Ø³Ø¤Ø§Ù„ Ø¹Ù† Ù‚Ø¨ÙˆÙ„ Ø£Ø³ØªØ§Ø°Ø©"),
    (1183, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø§Ø°Ø§ Ø¬Ø¨Øª Ø³ÙƒÙ„ÙŠÙ Ù…Ø§ ÙŠØ­Ø³Ø¨ Ù„ÙŠ ØºÙŠØ§Ø¨ ÙˆÙ„Ø§ ØºÙŠØ§Ø¨Ø§ØªÙŠ ØªØ²ÙŠØ¯ = Ø³Ø¤Ø§Ù„"),
    (1184, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ØºØ¨Øª ÙŠÙˆÙ… Ø§Ø®ØªØ¨Ø§Ø± ÙˆÙ‚Ø¯Ù…Øª Ø¹Ø°Ø± Ø·Ø¨ÙŠ ÙˆØ´ Ø§Ù„Ø­Ù„ = Ø´ÙƒÙˆÙ‰"),
    (1187, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø¹Ù†Ø¯ÙŠ Ø³ÙƒÙ„ÙŠÙ Ø§Ø¬Ø§Ø²Ø§Øª = ØªØ¹Ù„ÙŠÙ‚ Ù‚ØµÙŠØ± Ø¹Ø§Ø¯ÙŠ"),
    (1190, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ÙŠÙ…Ø¯ÙŠ Ø§Ø¹ÙŠØ¯ Ø§Ø®ØªØ¨Ø§Ø± Ù…ÙŠØ¯ Ø¨Ø§Ø´Ø¹Ø§Ø± Ù…Ø±Ø§Ø¬Ø¹Ù‡ Ø§Ùˆ Ù„Ø§Ø²Ù… Ø¹Ø°Ø± Ø³ÙƒÙ„ÙŠÙ = Ø³Ø¤Ø§Ù„"),
    (1193, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø§Ø­Ø¯ ÙŠØ³Ø§Ø¹Ø¯Ù†ÙŠ Ø§Ø°Ø§ Ø¬Ø¨Øª Ø³ÙƒÙ„ÙŠÙ ÙƒÙŠÙ Ø£ÙˆØµÙ„Ù‡ Ù„Ù„Ø¯ÙƒØªÙˆØ±Ù‡ = Ø³Ø¤Ø§Ù„ Ø¥Ø¯Ø§Ø±ÙŠ"),
    (1194, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ù‡Ùˆ Ø·Ø¨ÙŠØ¹ÙŠ Ø§Ù†Ù‡ Ù…Ø§Ù‚Ø¯ Ù†Ø²Ù„ Ù„ÙŠ ÙˆÙ„Ø§ Ù‚Ø±ÙŠØ¯ = Ø³Ø¤Ø§Ù„ Ø¹Ø§Ø¯ÙŠ Ø¹Ù† Ø§Ù„Ø¯Ø±Ø¬Ø§Øª"),

    # ========================================================
    # ACADEMIC CHEATING â†’ NORMAL (student discussions, not cheating)
    # ========================================================
    (1778, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø§Ø¹ØªÙ…Ø§Ø¯ Ø­Ù„ÙˆÙ„ Ø§Ù„ÙˆØ§Ø¬Ø¨Ø§Øª ÙˆØ§Ù„Ù…Ø°Ø§ÙƒØ±Ø© - ØªØ¹Ù„ÙŠÙ‚ Ø¹Ø§Ø¯ÙŠ"),
    (1797, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ù†ØµÙŠØ­Ø© Ø¹Ù† ÙƒÙŠÙÙŠØ© Ø§Ù„Ù†Ø¬Ø§Ø­ ÙˆØ§Ù„ØªØ¬Ø§ÙˆØ¨ Ù…Ø¹ Ø§Ù„Ø¯ÙƒØªÙˆØ±Ø© - Ù†ØµÙŠØ­Ø© Ø·Ø¨ÙŠØ¹ÙŠØ©"),
    (1773, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø¹Ù†Ø¯Ù†Ø§ Ø¨Ø­Ø« Ø¬Ø§Ù‡Ø² Ù„Ù„Ù†Ø´Ø± ÙŠØ¨Ø­Ø« Ø¹Ù† Ù…Ø´Ø§Ø±ÙƒØ© - Ù†Ø´Ø± Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ Ù…Ø´Ø±ÙˆØ¹"),

    # ========================================================
    # FINANCIAL SCAMS â†’ NORMAL (discussions about trading, not scamming)
    # ========================================================
    (582, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø´Ø±Ø­ Ø¹Ù…Ù„Ø© PAXG Ø¨Ø´Ø§Ø±Øª Ø§Ù„Ø°Ù‡Ø¨ ÙÙŠ Ø§Ù„ØªØ¯Ø§ÙˆÙ„ Ø§Ù„ÙÙˆØ±ÙŠ - Ù…Ø¹Ù„ÙˆÙ…Ø©"),
    (587, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø®Ø¨Ø±: Ø±ÙˆØ³ÙŠØ§ ØªØ¶Ø¹ Ù…Ø´Ø±ÙˆØ¹ Ù‚Ø§Ù†ÙˆÙ† Ù„ØªØ¯Ø§ÙˆÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø´ÙØ±Ø©"),
    (596, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ù†ØµÙŠØ­Ø© Ø¹Ù† Ø¹Ø¯Ù… Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø¶ Ù…Ù† Ø§Ù„ÙÙŠØ²Ø§ - Ù†ØµÙŠØ­Ø© Ù…Ø§Ù„ÙŠØ©"),
    (599, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø¹Ù†Ø¯ÙŠ 50 Ø¯ÙˆÙ„Ø§Ø± ÙˆÙ…Ù†ØªØ¸Ø± Ø§Ù„Ø°Ù‡Ø¨ ÙŠÙ†Ø²Ù„ - ØªØ¹Ù„ÙŠÙ‚ Ø´Ø®ØµÙŠ"),

    # ========================================================
    # SPAM â†’ NORMAL (questions and casual discussions)
    # ========================================================
    (784, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø³Ø¤Ø§Ù„: Ù‡Ù„ Ø´Ø±Ø§Ø¡ Ø¨Ø·Ø§Ù‚Ø§Øª Ø£Ù…Ø§Ø²ÙˆÙ† ØªÙØªØ­ Ù„Ø§ÙˆÙ†Ø¬Ø§Øª Ø§Ù„Ù…Ø·Ø§Ø±"),
    (789, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø­Ø³Ø¨ Ø¹Ù„Ù…ÙŠ Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ù†ØªÙÙ„ÙƒØ³ ÙˆØ´Ø§Ù‡Ø¯ - ØªØ¹Ù„ÙŠÙ‚ Ø¹Ø§Ø¯ÙŠ"),
    (791, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø§Ù„Ù…Ø¨ÙŠØ¹Ø§Øª Ù…Ùˆ Ù…Ø±Ù‡ Ø¹Ø§Ù„ÙŠÙ‡ Ø¨Ø³ Ø¨Ø¯Ø§ÙŠØ© Ø­Ù„ÙˆÙ‡ - ØªØ¹Ù„ÙŠÙ‚ Ø¹Ø§Ø¯ÙŠ Ø¹Ù† ØªØ¬Ø§Ø±Ø©"),
    (793, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ÙˆØ´ Ø£ÙƒÙˆØ§Ø¯ Ø®ØµÙ… Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø§Ù‡Ù„ÙŠ Ù…Ø¹ Ø£Ù…Ø§Ø²ÙˆÙ† = Ø³Ø¤Ø§Ù„"),
    (794, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø·Ø¨ÙŠØ¹ÙŠ Ø§Ù„Ù…Ø´Ø§Ù‡Ø¯Ø§Øª Ù‚Ù„ÙŠÙ„Ø© ÙˆÙŠÙ…ÙƒÙ† Ù…Ø´ÙƒÙ„Ø© Ø¨Ø§Ù„ÙˆØµÙˆÙ„ = ØªØ¹Ù„ÙŠÙ‚ Ø¹Ø§Ø¯ÙŠ"),

    # ========================================================
    # SPAM â†’ FINANCIAL SCAMS (investment scams labeled as spam)
    # ========================================================
    (775, "Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ (Ø¹Ø±Ø¶)", ["Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ (Ø¹Ø±Ø¶)"],
     "Ø¹ÙˆØ§Ø¦Ø¯ Ù…Ø¶Ù…ÙˆÙ†Ø© ÙˆØ§Ø³ØªÙ‚Ø±Ø§Ø± Ù…Ø§Ù„ÙŠ Ø§Ù†Ø¶Ù… Ù„Ù…Ø³ØªØ«Ù…Ø±ÙŠÙ†Ø§ = Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ"),
    (777, "Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ (Ø¹Ø±Ø¶)", ["Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ (Ø¹Ø±Ø¶)"],
     "Ø¹ÙˆØ§Ø¦Ø¯ Ù…Ø¶Ù…ÙˆÙ†Ø© ÙˆØ§Ø³ØªÙ‚Ø±Ø§Ø± Ù…Ø§Ù„ÙŠ = Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ"),

    # ========================================================
    # WRONG CATEGORY fixes
    # ========================================================
    (189, "Ø³Ø¨Ø§Ù…", ["Ø³Ø¨Ø§Ù…"],
     "Ø®Ø¯Ù…Ø§Øª Ø­ÙƒÙˆÙ…ÙŠØ© ÙˆØ±Ø®Øµ Ù‚ÙŠØ§Ø¯Ø© - Ù„ÙŠØ³ ØºØ´ Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ"),
    (394, "Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø¹Ø±Ø¶)", ["Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø¹Ø±Ø¶)", "ØºØ´ Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ (Ø¹Ø±Ø¶)"],
     "Ø£Ø¹Ø°Ø§Ø± Ø·Ø¨ÙŠØ© ØµØ­ØªÙŠ Ø£ÙˆÙ„Ø§Ù‹ Ø«Ù… Ø¨Ø­ÙˆØ«Ø§Øª - Ø·Ø¨ÙŠ Ø£ÙˆÙ„Ø§Ù‹"),
    (797, "Ø³Ø¨Ø§Ù…", ["Ø³Ø¨Ø§Ù…"],
     "Ù…ØªÙˆÙØ± Ø±Ø´Ù‚ ÙƒÙ„ Ø§Ù„Ø¨Ø±Ø§Ù…Ø¬ Ù…ØªØ§Ø¨Ø¹ÙŠÙ† Ù„Ø§ÙŠÙƒØ§Øª = Ø³Ø¨Ø§Ù… ÙˆÙ„ÙŠØ³ ØªÙ‡ÙƒÙŠØ±"),
    (999, "Ø³Ø¨Ø§Ù…", ["Ø³Ø¨Ø§Ù…"],
     "Ø®Ø¯Ù…Ø§Øª ØªØ·ÙˆÙŠØ± ÙˆØªØµÙ…ÙŠÙ… Ù…ÙˆØ§Ù‚Ø¹ Ø§Ø­ØªØ±Ø§ÙÙŠØ© = Ø³Ø¨Ø§Ù… ÙˆÙ„ÙŠØ³ Unethical"),
    (1396, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ÙØ±ØµØ© Ø¨Ø­Ø«ÙŠØ© Ù…Ù…ÙŠØ²Ø© Ù†Ø´Ø± Ø¹Ù„Ù…ÙŠ ÙÙŠ Ù…Ø¬Ù„Ø§Øª Ù…Ø­ÙƒÙ…Ø© = Ù†Ø´Ø± Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ Ù…Ø´Ø±ÙˆØ¹"),
    (1593, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ù„ÙŠØ´ Ø³ÙˆÙˆ ÙƒØ°Ø§ ÙÙŠ Ø§Ø®ØªØ±Ø§Ù‚ Ø´ÙŠ = Ø³Ø¤Ø§Ù„ Ø¹Ø§Ø¯ÙŠ"),
    (1594, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø±Ø§Ù‚Ø¨Ù‡Ù… ÙˆØ§Ø³Ø£Ù„Ù‡Ù… ÙˆØªØ¬Ø³Ø³ Ø¹Ù„ÙŠÙ‡Ù… Ø´ÙˆÙ ÙƒÙŠÙ ÙŠØ±Ø¨Ø­Ùˆ = ØªØ¹Ù„ÙŠÙ‚ Ø³Ø§Ø®Ø±"),
    (780, "Ø³Ø¨Ø§Ù…", ["Ø³Ø¨Ø§Ù…"],
     "ÙˆØ¸Ø§Ø¦Ù Ø³Ø¹ÙˆØ¯Ø© Ø¨Ø¯ÙˆÙ† Ø¹Ù…Ù„ = Ø¥Ø¹Ù„Ø§Ù† Ø³Ø¨Ø§Ù… ÙˆÙ„ÙŠØ³ Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ"),
    (1798, "Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø¹Ø±Ø¶)", ["Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø¹Ø±Ø¶)"],
     "Ø§Ø¬Ø§Ø²Ø§Øª Ù…Ø±Ø¶ÙŠØ© ØªÙ†Ø²Ù„ ÙÙŠ ØµØ­ØªÙŠ Ù…Ø¶Ù…ÙˆÙ† = Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ ÙˆÙ„ÙŠØ³ Ø·Ø¨ÙŠØ¹ÙŠ"),

    # ========================================================
    # NORMAL â†’ ACADEMIC CHEATING (hidden violations)
    # ========================================================
    (2047, "ØºØ´ Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ (Ø·Ù„Ø¨)", ["ØºØ´ Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ (Ø·Ù„Ø¨)"],
     "Ù…Ù† Ø¹Ù†Ø¯Ù‡ ÙˆØ§Ø¬Ø¨ Ø§Ù„ÙÙŠØ²ÙŠØ§Ø¡ Ø­Ù„ ØªØ¬Ø±Ø¨Ø© Ø§Ù„Ø¨Ù†Ø¯ÙˆÙ„ = Ø·Ù„Ø¨ Ø­Ù„"),
]


def main():
    print("=" * 60)
    print("ðŸ”§ Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø¹ÙŠÙ†Ø§Øª - Ø§Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„Ø«Ø§Ù„Ø«Ø© (Ø¥Ø¹Ø§Ø¯Ø© ØªØ¯Ù‚ÙŠÙ‚ Ø´Ø§Ù…Ù„Ø©)")
    print("=" * 60)

    with open(DATA_PATH, "r", encoding="utf-8") as f:
        data = json.load(f)

    print(f"ðŸ“Š Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹ÙŠÙ†Ø§Øª: {len(data)}")

    os.makedirs(BACKUP_DIR, exist_ok=True)
    ts = datetime.now().strftime("%Y%m%d_%H%M%S")
    backup_path = os.path.join(BACKUP_DIR, f"training_data_pre_fix_r3_{ts}.json")
    shutil.copy2(DATA_PATH, backup_path)
    print(f"ðŸ’¾ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©: {backup_path}")

    print("\nðŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø¥ØµÙ„Ø§Ø­:")
    before = Counter(d["label"] for d in data)
    for k, v in before.most_common():
        print(f"  {k}: {v}")

    print(f"\nðŸ”§ ØªØ·Ø¨ÙŠÙ‚ {len(FIXES)} Ø¥ØµÙ„Ø§Ø­...")
    print("-" * 60)

    fix_count = 0
    skipped = 0
    for idx, new_label, new_labels, reason in FIXES:
        if idx >= len(data):
            print(f"  âš ï¸  [{idx}] Ø®Ø§Ø±Ø¬ Ø§Ù„Ù†Ø·Ø§Ù‚")
            continue

        sample = data[idx]
        old_label = sample.get("label", "")
        old_labels = sample.get("labels", [])

        if old_label == new_label and old_labels == new_labels:
            skipped += 1
            continue

        sample["label"] = new_label
        sample["labels"] = new_labels
        sample["note"] = f"Fix R3: {old_label} -> {new_label} ({reason})"
        sample["reviewed_at"] = datetime.now().isoformat()
        sample["reviewed_by"] = "full_audit_r3_feb2026"

        fix_count += 1
        text_preview = sample["text"][:50].replace('\n', ' ')
        print(f"  âœ… [{idx}] {old_label} -> {new_label}")
        print(f"       {text_preview}...")

    if skipped:
        print(f"\n  â­ï¸  ØªØ®Ø·ÙŠ {skipped} Ø¹ÙŠÙ†Ø© (Ø¨Ø§Ù„ÙØ¹Ù„ ØµØ­ÙŠØ­Ø©)")

    with open(DATA_PATH, "w", encoding="utf-8") as f:
        json.dump(data, f, ensure_ascii=False, indent=2)

    print(f"\nðŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¨Ø¹Ø¯ Ø§Ù„Ø¥ØµÙ„Ø§Ø­:")
    after = Counter(d["label"] for d in data)
    for k, v in after.most_common():
        diff = v - before.get(k, 0)
        marker = f" ({'+' if diff > 0 else ''}{diff})" if diff != 0 else ""
        print(f"  {k}: {v}{marker}")

    print(f"\nâœ… ØªÙ… Ø¥ØµÙ„Ø§Ø­ {fix_count} Ø¹ÙŠÙ†Ø© (Ù…Ù† {len(FIXES)} Ù…Ø·Ù„ÙˆØ¨Ø©)")
    print(f"ðŸ’¾ Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©: {backup_path}")


if __name__ == "__main__":
    main()
