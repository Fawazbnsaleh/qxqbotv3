"""
Fix Mislabeled Training Samples - Round 5 (Fifth Full Re-audit)
Focus on remaining medical fraud questions and miscellaneous cross-category fixes.
"""
import json
import os
import shutil
from datetime import datetime
from collections import Counter

DATA_PATH = "al_rased/data/labeledSamples/training_data.json"
BACKUP_DIR = "al_rased/data/labeledSamples/backups"

FIXES = [
    # ========================================================
    # MEDICAL FRAUD (Ø¹Ø±Ø¶) â†’ NORMAL (questions/comments about sick leaves)
    # These are student discussions, not offers to sell sick leaves
    # ========================================================
    (1046, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø¹Ù†Ø¯ÙŠ Ø¹Ø°Ø± Ø·Ø¨ÙŠ Ø§Ø±Ø³Ù„ Ø¨Ø³ ÙÙŠ Ø§Ø¹Ø°Ø§Ø± Ø§Ù„ØªØºÙŠØ¨ Ø¹Ù†Ø¯ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ØµØ­ = Ø³Ø¤Ø§Ù„"),
    (1048, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø·Ø¨ÙŠØ¹ÙŠÙŠÙŠ ØªØ­Ù…Ù„ Ù…ÙˆØ§Ø¯ Ø¹Ø§Ø¯ÙŠ Ù„Ø§ØªØ´ÙŠÙ„ Ù‡Ù… = Ù†ØµÙŠØ­Ø©"),
    (1052, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø±Ø§Ø­ Ø¹Ù„ÙŠÙƒ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ÙˆÙ…Ø¹Ùƒ Ø³ÙƒÙ„ÙŠÙ ÙƒÙŠÙ Ø§Ù‚Ø¯Ù… Ø§Ù„Ø¹Ø°Ø± = Ø³Ø¤Ø§Ù„ Ø¥Ø¯Ø§Ø±ÙŠ"),
    (1054, "Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø·Ù„Ø¨)", ["Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø·Ù„Ø¨)"],
     "Ø§ÙŠ Ø§Ø­Ø¯ ÙŠØ¹Ø±Ù ÙŠØ³ÙˆÙŠ Ø³ÙƒÙ„ÙŠÙ Ø«Ù‚Ø© ÙˆØ³Ø±Ø¹Ø© = Ø·Ù„Ø¨ Ø´Ø±Ø§Ø¡"),
    (1056, "Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø·Ù„Ø¨)", ["Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø·Ù„Ø¨)"],
     "Ø§Ù„ÙŠ ÙŠØ¨ÙŠ Ø³ÙƒÙ„ÙŠÙ Ù…Ø¶Ù…ÙˆÙ†Ù‡ = Ø·Ù„Ø¨ Ø´Ø±Ø§Ø¡ Ø§ÙŠØ¶Ø§Ù‹"),
    (1057, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ØµØ­ØªÙŠ Ù…Ø§ ÙŠØ¨ÙŠØ¹ÙˆÙ† Ø³ÙƒÙ„ÙŠÙ = ØªØ¹Ù„ÙŠÙ‚ Ø³Ø§Ø®Ø±"),
    (1059, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ÙƒØ§Ù† Ø¹Ù†Ø¯ÙŠ ÙƒÙˆÙŠØ² ØºØ¨Øª ÙˆØ¹Ù†Ø¯ÙŠ Ø³ÙƒÙ„ÙŠÙ Ø§Ø¹Ø·ÙŠÙ‡ Ù„Ù„Ø¯ÙƒØªÙˆØ±Ù‡ ÙˆØ±Ù‚Ù‡ ÙˆÙ„Ø§ ÙƒÙŠÙ = Ø³Ø¤Ø§Ù„"),
    (1060, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ØºØ¨Øª Ø¹Ù† ÙØ§ÙŠÙ†Ù„ ÙˆÙ‚Ø¯Ù…Øª Ø¹Ø°Ø±ÙŠ ÙˆÙ„Ù„Ø­ÙŠÙ† Ù…Ø§Ø±Ø¯ÙˆØ§ Ø¹Ù„ÙŠ = Ø´ÙƒÙˆÙ‰"),
    (1061, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø§Ø°Ø§ ÙˆØµÙ„ Ø§Ù„Ù…Ø¹Ø¯Ù„ 1 Ù‡Ù„ ØªÙ†Ù‚Ø·Ø¹ Ø§Ù„Ù…ÙƒØ§ÙØ£Ø© = Ø³Ø¤Ø§Ù„ Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ"),
    (1062, "ØºÙŠØ± Ø£Ø®Ù„Ø§Ù‚ÙŠ (Ø¹Ø±Ø¶)", ["ØºÙŠØ± Ø£Ø®Ù„Ø§Ù‚ÙŠ (Ø¹Ø±Ø¶)"],
     "Ù…Ø­ØªÙˆÙ‰ Ø¥Ø¨Ø§Ø­ÙŠ ØµØ±ÙŠØ­ = ØºÙŠØ± Ø£Ø®Ù„Ø§Ù‚ÙŠ ÙˆÙ„ÙŠØ³ Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ"),
    (1063, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø·Ø¨ÙŠØ¹ÙŠ Ù… ÙŠØ±Ø¯ÙˆÙ† Ù„ÙŠ Ø§Ø³Ø¨ÙˆØ¹ Ù…Ø±Ø³Ù„Ù‡ = ØªØ¹Ù„ÙŠÙ‚ Ø¹Ù† ØªØ£Ø®Ø± Ø±Ø¯"),
    (1067, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ÙŠÙ‚Ø¨Ù„ÙˆÙ† Ø³ÙƒÙ„ÙŠÙ ØµØ­ØªÙŠ Ù…Ù† Ø§Ù„Ø§Ø³ØªØ´Ø§Ø±Ø§Øª Ø§Ù„ÙÙˆØ±ÙŠÙ‡ = Ø³Ø¤Ø§Ù„"),
    (1068, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø¹Ù†Ø¯ÙŠ Ø³ÙƒÙ„ÙŠÙ ÙƒÙŠÙ Ø§Ø±ÙÙ‚Ù‡ Ù„Ø¯ÙƒØ§ØªØ±ØªÙŠ = Ø³Ø¤Ø§Ù„ Ø¥Ø¯Ø§Ø±ÙŠ"),
    (1072, "Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø·Ù„Ø¨)", ["Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø·Ù„Ø¨)"],
     "ÙƒÙŠÙ Ø§Ø·Ù„Ø¹ Ø³ÙƒÙ„ÙŠÙ Ù…Ù† ØµØ­ØªÙŠ = Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø·Ù„Ø¨ Ø£Ùˆ Ø³Ø¤Ø§Ù„"),
    (1074, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ù…Ù† Ø¯Ø±Ø³ Ø­Ø³Ø§Ø¨ Ø§Ù„ØªÙØ§Ø¶Ù„ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ÙŠ Ù‡Ù„ Ù‡Ùˆ Ø³Ù‡Ù„ = Ø³Ø¤Ø§Ù„ Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ"),
    (1075, "Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø·Ù„Ø¨)", ["Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø·Ù„Ø¨)"],
     "Ø§Ø­ØªØ§Ø¬ Ø³ÙƒÙ„ÙŠÙ ÙÙŠ Ù…Ù†ØµØ© ØµØ­ØªÙŠ Ø§Ù„Ù„Ù‡ ÙŠØ³Ø¹Ø¯ÙƒÙ… = Ø·Ù„Ø¨ Ø´Ø±Ø§Ø¡"),
    (1076, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø·Ø¨ÙŠØ¹ÙŠ ÙŠØ§Ø®Ø°ÙˆØ§ ØºÙŠØ§Ø¨ Ø¹Ù„Ù‰ Ø§ÙˆÙ„ Ø§Ø³Ø¨ÙˆØ¹ = Ø³Ø¤Ø§Ù„ Ø¹Ù† Ø§Ù„ØºÙŠØ§Ø¨"),
    (1078, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø¹Ù†Ø¯ÙŠ Ø³ÙƒÙ„ÙŠÙ ÙÙŠ ØµØ­ØªÙŠ = Ù…Ø¬Ø±Ø¯ Ø¥Ø®Ø¨Ø§Ø± ÙˆÙ„ÙŠØ³ Ø¹Ø±Ø¶"),
    (1080, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø§Ù†Ù‚Ø¨Ù„ ÙˆØ§Ø®Ø° Ù…Ù†ÙƒÙ… Ø³ÙƒÙ„ÙŠÙ Ø§Ù† Ø´Ø§Ø¡ Ø§Ù„Ù„Ù‡ = ØªØ¹Ù„ÙŠÙ‚ Ø¹Ø§Ø¯ÙŠ"),
    (1085, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø§Ø­Ø³Ø¨ÙŠÙ‡ Ø¨ØªØ·Ø¨ÙŠÙ‚ Ø§Ø­Ø³Ø¨ Ù…Ø¹Ø¯Ù„ÙŠ = Ù†ØµÙŠØ­Ø© Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠØ©"),
    (1089, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø§Ø°Ø§ Ø§Ù„Ø³ÙƒÙ„ÙŠÙ Ù†Ø§Ø²Ù„ ÙÙŠ ØµØ­ØªÙŠ Ø§ØªÙˆÙ‚Ø¹ ÙŠÙ‚Ø¨Ù„ÙˆÙ†Ù‡ = ØªØ¹Ù„ÙŠÙ‚"),
    (1097, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø·Ù„Ø¹ Ù„ÙŠ Ø§Ø¬Ø§Ø²Ø© Ù…Ø±Ø¶ÙŠØ© Ù‡ÙŠ ÙˆØ­Ø¯Ø© Ø¹Ø°Ø± Ø·Ø¨ÙŠ = Ø³Ø¤Ø§Ù„"),

    # ========================================================
    # UNETHICAL â†’ NORMAL (student questions about mechanical engineering)
    # ========================================================
    (1499, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ÙˆØ§Ø­Ø¯ ÙŠØ¯Ø±Ø³ ØªÙ‚Ù†ÙŠØ© Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠØ© ÙŠØ¨ÙŠ ØªØ¯Ø±ÙŠØ¨ Ø¨Ø§Ø±Ø§Ù…ÙƒÙˆ = Ø³Ø¤Ø§Ù„"),
    (1512, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ù‚Ø±ÙˆØ¨ ÙÙŠØ²ÙŠØ§Ø¡ Ø­Ø¯ÙŠØ«Ø© ÙˆÙ…ÙŠÙƒØ§Ù†ÙŠÙƒØ§ Ø§Ù„ÙƒÙ… = Ø³Ø¤Ø§Ù„ Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ"),

    # ========================================================
    # UNETHICAL â†’ Ø³Ø¨Ø§Ù… (selling accounts, not actually unethical)
    # ========================================================
    (1506, "Ø³Ø¨Ø§Ù…", ["Ø³Ø¨Ø§Ù…"],
     "Ø¨ÙŠØ¹ Ù…Ø¹Ø±ÙØ§Øª ÙˆØ±ÙØ¹ Ù…Ù†ØµØ§Øª = Ø³Ø¨Ø§Ù… ÙˆÙ„ÙŠØ³ ØºÙŠØ± Ø£Ø®Ù„Ø§Ù‚ÙŠ"),

    # ========================================================
    # FINANCIAL SCAMS â†’ NORMAL (news article)
    # ========================================================
    (576, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ØªÙ‚Ø±ÙŠØ± Ø¹Ù† ØªØ¯ÙÙ‚Ø§Øª ØµÙ†Ø§Ø¯ÙŠÙ‚ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± ÙÙŠ Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø´ÙØ±Ø© = Ø®Ø¨Ø±"),

    # ========================================================  
    # FINANCIAL SCAMS â†’ SPAM (channel promotion, not scam)
    # ========================================================
    (577, "Ø³Ø¨Ø§Ù…", ["Ø³Ø¨Ø§Ù…"],
     "ØªØ±ÙˆÙŠØ¬ Ù‚Ù†Ø§Ø© ÙƒØ±ÙŠØ¨ØªÙˆ = Ø³Ø¨Ø§Ù… ÙˆÙ„ÙŠØ³ Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ"),

    # ========================================================
    # SPAM â†’ FINANCIAL SCAMS (investment scam ads)
    # ========================================================
    (769, "Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ (Ø¹Ø±Ø¶)", ["Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ (Ø¹Ø±Ø¶)"],
     "Ø¹ÙˆØ§Ø¦Ø¯ Ù…Ø¶Ù…ÙˆÙ†Ø© ÙˆØ§Ø³ØªÙ‚Ø±Ø§Ø± Ù…Ø§Ù„ÙŠ Ù…Ø¨Ù„Øº 8000 Ø¯ÙˆÙ„Ø§Ø± = Ø§Ø­ØªÙŠØ§Ù„"),
    (770, "Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ (Ø¹Ø±Ø¶)", ["Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ (Ø¹Ø±Ø¶)"],
     "Ø¹ÙˆØ§Ø¦Ø¯ Ù…Ø¶Ù…ÙˆÙ†Ø© ÙˆØ§Ø³ØªÙ‚Ø±Ø§Ø± Ù…Ø§Ù„ÙŠ Ù…Ø¨Ù„Øº 10000 Ø±ÙŠØ§Ù„ = Ø§Ø­ØªÙŠØ§Ù„"),

    # ========================================================
    # R4 OVERFIX: [489] was changed to Ø·Ø¨ÙŠØ¹ÙŠ but actually is Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ
    # "Ø§Ù„Ù„ÙŠ ÙŠØ¨ÙŠ ÙŠØ±ÙØ¹ Ø³ÙƒÙˆØ±Ù‡ ÙŠØ¬ÙŠ Ø®Ø§Øµ" = likely credit score scam service
    # ========================================================
    (489, "Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ (Ø¹Ø±Ø¶)", ["Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ (Ø¹Ø±Ø¶)"],
     "Ø§Ù„Ù„ÙŠ ÙŠØ¨ÙŠ ÙŠØ±ÙØ¹ Ø³ÙƒÙˆØ±Ù‡ ÙŠØ¬ÙŠ Ø®Ø§Øµ = Ø®Ø¯Ù…Ø© Ø±ÙØ¹ Ø³ÙƒÙˆØ± = Ø§Ø­ØªÙŠØ§Ù„"),

    # ========================================================
    # ACADEMIC CHEATING â†’ OTHER CATEGORY
    # ========================================================
    (182, "Ø³Ø¨Ø§Ù…", ["Ø³Ø¨Ø§Ù…"],
     "ØªØ·Ø¨ÙŠÙ‚ MyEx Ù„Ù…Ø´Ø§Ø±ÙƒØ© ØªØ¬Ø§Ø±Ø¨ Ø§Ù„Ù†Ø§Ø³ = Ø³Ø¨Ø§Ù… ØªØ±ÙˆÙŠØ¬ ØªØ·Ø¨ÙŠÙ‚"),
    (377, "Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø¹Ø±Ø¶)", ["Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø¹Ø±Ø¶)", "ØºØ´ Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ (Ø¹Ø±Ø¶)"],
     "Ø¥Ø¬Ø§Ø²Ø© Ù…Ø±Ø¶ÙŠØ© + Ø®Ø¯Ù…Ø§Øª Ø·Ù„Ø§Ø¨ÙŠØ© = Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ Ø£ÙˆÙ„Ø§Ù‹"),
    (392, "Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø¹Ø±Ø¶)", ["Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø¹Ø±Ø¶)", "ØºØ´ Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ (Ø¹Ø±Ø¶)"],
     "Ø£Ø¹Ø°Ø§Ø± Ø·Ø¨ÙŠØ© ÙˆØ±Ù‚ÙŠ + ÙƒÙ„ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø§Ù„Ø·Ù„Ø§Ø¨ÙŠØ© = Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ Ø£ÙˆÙ„Ø§Ù‹"),
    (395, "Ø³Ø¨Ø§Ù…", ["Ø³Ø¨Ø§Ù…"],
     "Ù…Ù„Ù Ø§Ù„Ø§Ø¯Ø§Ø¡ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ ÙˆÙ…Ù„Ù Ù†Ø§ÙØ³ ÙˆØ§Ù†Ø¬Ø§Ø² = Ø®Ø¯Ù…Ø§Øª Ø®Ø§Ø±Ø¬ Ø§Ù„Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ"),
]


def main():
    print("=" * 60)
    print("ðŸ”§ Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø¹ÙŠÙ†Ø§Øª - Ø§Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„Ø®Ø§Ù…Ø³Ø©")
    print("=" * 60)

    with open(DATA_PATH, "r", encoding="utf-8") as f:
        data = json.load(f)

    print(f"ðŸ“Š Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹ÙŠÙ†Ø§Øª: {len(data)}")

    os.makedirs(BACKUP_DIR, exist_ok=True)
    ts = datetime.now().strftime("%Y%m%d_%H%M%S")
    backup_path = os.path.join(BACKUP_DIR, f"training_data_pre_fix_r5_{ts}.json")
    shutil.copy2(DATA_PATH, backup_path)
    print(f"ðŸ’¾ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©: {backup_path}")

    print("\nðŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù‚Ø¨Ù„:")
    before = Counter(d["label"] for d in data)
    for k, v in before.most_common():
        print(f"  {k}: {v}")

    print(f"\nðŸ”§ ØªØ·Ø¨ÙŠÙ‚ {len(FIXES)} Ø¥ØµÙ„Ø§Ø­...")
    print("-" * 60)

    fix_count = 0
    skipped = 0
    for idx, new_label, new_labels, reason in FIXES:
        if idx >= len(data):
            continue
        sample = data[idx]
        old_label = sample.get("label", "")
        if old_label == new_label and sample.get("labels", []) == new_labels:
            skipped += 1
            continue

        sample["label"] = new_label
        sample["labels"] = new_labels
        sample["note"] = f"Fix R5: {old_label} -> {new_label} ({reason})"
        sample["reviewed_at"] = datetime.now().isoformat()
        sample["reviewed_by"] = "full_audit_r5_feb2026"

        fix_count += 1
        text_preview = sample["text"][:50].replace('\n', ' ')
        print(f"  âœ… [{idx}] {old_label} -> {new_label}")
        print(f"       {text_preview}...")

    if skipped:
        print(f"\n  â­ï¸  ØªØ®Ø·ÙŠ {skipped}")

    with open(DATA_PATH, "w", encoding="utf-8") as f:
        json.dump(data, f, ensure_ascii=False, indent=2)

    print(f"\nðŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¨Ø¹Ø¯:")
    after = Counter(d["label"] for d in data)
    for k, v in after.most_common():
        diff = v - before.get(k, 0)
        marker = f" ({'+' if diff > 0 else ''}{diff})" if diff != 0 else ""
        print(f"  {k}: {v}{marker}")

    print(f"\nâœ… ØªÙ… Ø¥ØµÙ„Ø§Ø­ {fix_count} Ø¹ÙŠÙ†Ø©")


if __name__ == "__main__":
    main()
