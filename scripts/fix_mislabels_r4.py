"""
Fix Mislabeled Training Samples - Round 4 (Fourth Full Re-audit)
Every single sample was read again. Focus on financial & unethical sections.
"""
import json
import os
import shutil
from datetime import datetime
from collections import Counter

DATA_PATH = "al_rased/data/labeledSamples/training_data.json"
BACKUP_DIR = "al_rased/data/labeledSamples/backups"

FIXES = [
    # ========================================================
    # FINANCIAL SCAMS â†’ NORMAL (trading conversations, news, questions)
    # ========================================================
    (473, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ÙƒÙŠÙ Ø·ÙŠØ¨ Ù…Ø§Ù„Ù‚ÙŠØªÙ‡Ù… Ø¨Ø§Ù„ØªØ¯Ø§ÙˆÙ„ Ø§Ù„ÙÙˆØ±ÙŠ = Ø³Ø¤Ø§Ù„ Ø¹Ø§Ø¯ÙŠ Ø¹Ù† ØªØ¯Ø§ÙˆÙ„"),
    (474, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ù‡Ù†Ø§Ùƒ Ø¹Ù…Ù„Ø§Øª ØªØ±Ø¨Ø­ Ø¯ÙˆÙ„Ø§Ø± = ØªØ¹Ù„ÙŠÙ‚ Ø¹Ø§Ø¯ÙŠ Ø¹Ù† Ø¹Ù…Ù„Ø§Øª"),
    (477, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø·ÙŠØ¨ Ù…Ø§ ØªØªØ¯Ø§ÙˆÙ„ÙŠ ÙÙŠ Ø§Ù„Ø°Ù‡Ø¨ Ø£ÙØ¶Ù„ = Ù†ØµÙŠØ­Ø© Ø¹Ø§Ø¯ÙŠØ©"),
    (478, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø§Ù†Ø§ ÙƒØ§Ù† Ù…Ø¹Ø§ÙŠØ§ Ø­Ø³Ø§Ø¨ Ù‚Ø¯ÙŠÙ… Ø§ÙˆÙ„ Ù…Ø±Ù‡ Ø§ØªØ¯Ø§ÙˆÙ„ = ØªØ¹Ù„ÙŠÙ‚ Ø´Ø®ØµÙŠ"),
    (485, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø®ØµÙ… Ø±Ø³ÙˆÙ… ØªØ¯Ø§ÙˆÙ„ ÙˆÙ„ÙŠØ³ Ø¹Ù…Ù„Ø§Øª Ø±Ù‚Ù…ÙŠØ© = ØªÙˆØ¶ÙŠØ­"),
    (486, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ÙŠØ¹Ù†ÙŠ Ø§ØªØ¯Ø§ÙˆÙ„ Ø¨ÙŠÙ‡Ø§ Ø¹Ù„Ù‰ Ø§ÙŠ Ø¹Ù…Ù„Ø§Øª = Ø³Ø¤Ø§Ù„"),
    (488, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ÙƒØ§Ù† Ù„Ø§Ø²Ù… ØªØ´ØªØ±Ùƒ ÙÙŠÙ‡ Ù‚Ø¨Ù„ Ø§Ù„ØªØ¯Ø§ÙˆÙ„ = ØªØ¹Ù„ÙŠÙ‚"),
    (491, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ÙÙŠÙ‡ Ø´Ø®Øµ ÙƒØ°Ø¨ Ø¹Ù„ÙŠ Ù†Ù‡Ø¨ 50 Ø¯ÙˆÙ„Ø§Ø± = Ø´ÙƒÙˆÙ‰ Ù…Ù† Ø§Ù„Ø§Ø­ØªÙŠØ§Ù„"),
    (492, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø§Ù„ÙŠ Ù‡Ùˆ Ø§ÙŠØ¯Ø§Ø¹ 100 ÙˆØªØ¯Ø§ÙˆÙ„ 10 Ù‡Ùˆ Ø³ÙŠÙˆÙ„ØªÙ‡ Ø®Ù„ØµØ§Ù†Ù‡ = Ø³Ø¤Ø§Ù„"),
    (497, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø®Ø¨Ø±: Ø¨Ù†Ùƒ DZ Ø§Ù„Ø£Ù„Ù…Ø§Ù†ÙŠ ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ ØªØ¯Ø§ÙˆÙ„ Ø§Ù„Ø¨ÙŠØªÙƒÙˆÙŠÙ†"),
    (736, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø£Ø®Ø¨Ø§Ø± Ø§Ù„Ø¹Ù…Ù„Ø§Øª: Ø­Ø¬Ù… ØªØ¯Ø§ÙˆÙ„ Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø³ØªÙ‚Ø±Ø© Ø³Ø¬Ù„ Ù…Ø³ØªÙˆÙ‰ Ù‚ÙŠØ§Ø³ÙŠ"),
    (733, "Ø³Ø¨Ø§Ù…", ["Ø³Ø¨Ø§Ù…"],
     "Ø£Ø®Ø¨Ø§Ø± Ù…ØªØ¯Ø§ÙˆÙ„Ø© Ø±Ø§Ø¨Ø· Ù‚Ù†Ø§Ø© ÙˆØ§ØªØ³Ø§Ø¨ = Ø³Ø¨Ø§Ù… ØªØ±ÙˆÙŠØ¬ Ù‚Ù†Ø§Ø©"),
    (743, "Ø³Ø¨Ø§Ù…", ["Ø³Ø¨Ø§Ù…"],
     "Ø®Ø¯Ù…Ø§Øª ØªØµÙ…ÙŠÙ… Ù…ÙˆØ§Ù‚Ø¹ ÙˆÙŠØ¨ = Ø³Ø¨Ø§Ù… ÙˆÙ„ÙŠØ³ financial scams"),

    # ========================================================
    # FINANCIAL/Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ â†’ NORMAL (questions/comments, not scams)
    # ========================================================
    (476, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ù…Ø§Ù„Ù‡Ø§ ÙˆÙ‚Øª Ù…Ø¹ÙŠÙ† Ø¨Ø³ Ø¨Ø¹Ø¯ Ù…Ø§ÙŠÙ‚ÙÙ„ ÙŠØ¨Ø¯ÙˆÙ† ÙŠØ¯Ù‚Ù‚ÙˆÙ† Ø§Ù„ÙˆØ«Ø§Ø¦Ù‚ = ØªØ¹Ù„ÙŠÙ‚ Ø¹Ø§Ø¯ÙŠ"),
    (479, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ø±Ø¨Ø­ 3 Ø§Ùˆ 4 Ø¯ÙˆÙ„Ø§Ø± Ù…Ø¬Ø§Ù†Ø§ = Ø³Ø¤Ø§Ù„ Ø³Ø§Ø°Ø¬"),
    (481, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ØªØ±Ø§Ù‡ Ù…Ù‚Ø±Ù ÙˆÙƒØ°ÙˆØ¨ Ø§Ù„Ù„Ù‡ ÙŠØ§Ø®Ø°Ùƒ = Ø´ØªÙŠÙ…Ø© Ù„Ù†ØµØ§Ø¨ = Ø·Ø¨ÙŠØ¹ÙŠ"),
    (483, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ÙŠØ±ØªÙØ¹ Ø§Ø°Ø§ Ø²Ø§Ø¯Øª Ù…Ù†ØªØ¬Ø§ØªÙƒ Ø§Ù„ØªÙ…ÙˆÙŠÙ„ÙŠØ© = Ù†ØµÙŠØ­Ø© Ø¹Ù† Ø§Ù„Ø³ÙƒÙˆØ±"),
    (487, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø§Ø­Ø¯ ÙŠØ¨ÙŠ ÙŠØ¯Ø®Ù„ Ø­Ø±Ø¨ Ø³Ø±ÙŠØ¹ Ø¨Ø¨Ø¯Ø§ = ÙƒÙ„Ø§Ù… Ø¹Ù† Ù„Ø¹Ø¨Ø©"),
    (493, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ØªØ·Ø¨ÙŠÙ‚ Ø¹ÙˆØ§Ø¦Ø¯ ÙƒÙ… Ù…Ø¯Ø© ÙˆØµÙˆÙ„ Ø§Ù„Ù…Ø¨Ù„Øº Ø¨Ø¹Ø¯ Ø§Ù„Ø³Ø­Ø¨ = Ø³Ø¤Ø§Ù„"),
    (495, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø±Ø¨Ø­ ØµØ§ÙÙŠ Ø¨ØµÙÙ‚Ø© Ø³Ø§Ø¹Ø© 102 Ø¯ÙˆÙ„Ø§Ø± Ù‡Ù„ Ø§Ø®Ø±Ø¬ = Ø³Ø¤Ø§Ù„ ØªØ¯Ø§ÙˆÙ„ Ø´Ø®ØµÙŠ"),
    (498, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø§Ø­Ø¯ Ù†Ø²Ù„Øª Ù„Ù‡ Ø¹Ù…ÙˆÙ„Ø© Ø´Ù‡Ø± 10 Ù…ÙŠÙ„Ø§Ø¯ÙŠ ÙÙŠ Ø§ÙŠ Ù‚Ø³Ù… = Ø³Ø¤Ø§Ù„"),
    (734, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø¹Ù†Ø¯ÙŠ ØªÙ…ÙˆÙŠÙ„ ÙÙŠ Ø§Ù…ÙƒØ§Ù† ÙˆØ¨Ø³ÙˆÙŠ Ø³Ø¯Ø§Ø¯ Ù…Ø¨ÙƒØ± = Ø³Ø¤Ø§Ù„ Ø¹Ù† ØªÙ…ÙˆÙŠÙ„"),
    (475, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø´ÙƒØ±Ø§Ù‹ Ù‡Ø°Ø§ Ø±Ø¨Ø­ Ø§Ø³ØªØ«Ù…Ø§Ø±ÙŠ Ø£Ù…Ø³ ÙˆØ³Ø­Ø¨ØªÙ‡ Ø§Ù„Ø­Ù…Ø¯Ù„Ù„Ù‡ = ØªØ¹Ù„ÙŠÙ‚"),

    # ========================================================
    # SPAM â†’ FINANCIAL SCAMS (investment scams mislabeled as spam)
    # ========================================================
    (744, "Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ (Ø¹Ø±Ø¶)", ["Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ (Ø¹Ø±Ø¶)"],
     "Ø¹ÙˆØ§Ø¦Ø¯ Ù…Ø¶Ù…ÙˆÙ†Ø© ÙˆØ§Ø³ØªÙ‚Ø±Ø§Ø± Ù…Ø§Ù„ÙŠ = Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ"),
    (749, "Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ (Ø¹Ø±Ø¶)", ["Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ (Ø¹Ø±Ø¶)"],
     "Ø¹ÙˆØ§Ø¦Ø¯ Ù…Ø¶Ù…ÙˆÙ†Ø© ÙˆØ§Ø³ØªÙ‚Ø±Ø§Ø± Ù…Ø§Ù„ÙŠ = Ø§Ø­ØªÙŠØ§Ù„ Ù…Ø§Ù„ÙŠ"),

    # ========================================================
    # HACKING â†’ NORMAL (crypto education/news, not hacking)
    # ========================================================
    (737, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø£Ø®Ø¨Ø§Ø± Ø¨ÙŠÙ†Ø§Ù†Ø³ ÙˆØ¥ÙŠØ«ÙŠØ±ÙŠÙˆÙ… ÙˆØºÙˆÙ„Ø¯Ù…Ø§Ù† Ø³Ø§ÙƒØ³ = Ø£Ø®Ø¨Ø§Ø± ÙƒØ±ÙŠØ¨ØªÙˆ"),
    (739, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ù‡Ù„ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø£Ù…ÙˆØ§Ù„ Ø§Ù„Ù…ÙÙ‚ÙˆØ¯Ø© ÙÙŠ Ø§Ù„ÙƒØ±ÙŠØ¨ØªÙˆ = ØªØ¹Ù„ÙŠÙ…"),

    # ========================================================
    # MORE HACKATHON â†’ NORMAL (students seeking hackathon teams)
    # ========================================================
    (1570, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø³Ù…Ø¹Øª Ø¹Ù† Ø§Ù„Ù…Ù„ØªÙ‚Ù‰ Ø§Ù„Ø¹Ù„Ù…ÙŠ Ù‡Ù„ Ù‡Ùˆ Ù…Ø«Ù„ Ø§Ù„Ù‡Ø§ÙƒØ«ÙˆÙ† = Ø³Ø¤Ø§Ù„"),
    (1571, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø§Ù„ÙŠ ÙŠØ¨ÙŠ ÙŠØ´Ø§Ø±Ùƒ Ø¨Ù…Ø³Ø§Ø¨Ù‚Ù‡ Ù‡Ø§ÙƒØ«ÙˆÙ† ÙŠÙƒÙ„Ù…Ù†ÙŠ = Ù†Ø´Ø§Ø· Ø·Ù„Ø§Ø¨ÙŠ"),

    # ========================================================
    # UNETHICAL â†’ NORMAL (student discussions containing "Ù…ÙŠÙƒØ§Ù†ÙŠÙƒ" etc.)
    # ========================================================
    (1500, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø§Ø¨ÙŠ Ø§Ø±Ù‚Ø§Ù… Ø´Ø¹Ø¨ Ø§Ù„Ø·Ø±Ù‚ Ø§Ù„Ù†Ø¸Ø±ÙŠØ© Ù„Ù„ÙÙŠØ²ÙŠØ§Ø¡ ÙˆÙ…ÙŠÙƒØ§Ù†ÙŠÙƒØ§ ØªÙ‚Ù„ÙŠØ¯ÙŠØ© = Ø³Ø¤Ø§Ù„"),
    (1501, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ù‡Ù„ ÙÙŠÙ‡ ØªØ¬Ø³ÙŠØ± ÙÙŠ Ø¬Ø§Ù…Ø¹Ù‡ Ø´Ù‚Ø±Ø§ ØªØ®ØµØµ Ù‡Ù†Ø¯Ø³Ø© Ù…ÙŠÙƒØ§Ù†ÙŠÙƒØ§ = Ø³Ø¤Ø§Ù„"),
    (1502, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ù…ÙŠÙ† ØªØ®ØµØµÙ‡ Ù‡Ù†Ø¯Ø³Ø© Ø¨ÙŠØ¦ÙŠØ© Ø§Ùˆ Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠØ© Ø§Ùˆ ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© = Ø³Ø¤Ø§Ù„"),
    (1503, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ÙŠØ§Ø³Ø§ØªØ± Ø§Ù‡Ù†ÙŠÙƒ Ø³Ø¨Ù‚ØªÙ†ÙŠ Ø¨Ø§Ù„Ø§Ù†Ø¬Ø§Ø² = ØªÙ‡Ù†Ø¦Ø© Ø¹Ø§Ø¯ÙŠØ©"),
    (1504, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø¨Ù†Ø§Øª Ø§Ù„ÙŠ ØªØ¨ÙŠ ØªØ´ØªØ±ÙŠ Ù…Ù†ÙŠÙƒØ§Ù† ØªØ¬ÙŠÙ†ÙŠ Ø®Ø§Øµ = Ø¨ÙŠØ¹ Ù…Ø§Ù†ÙŠÙƒØ§Ù†"),
    (1505, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ù‚Ø¨Ù„ Ø£Ø³Ø¨ÙˆØ¹ÙŠÙ† Ø¹Ù„Ù‰ ØªØ®ØµØµÙŠÙ† Ø§Ù„Ù‡Ù†Ø¯Ø³Ø© Ø§Ù„Ù…ÙŠÙƒØ§Ù†ÙŠÙƒÙŠØ© ÙˆØ§Ù„ÙƒÙ‡Ø±Ø¨Ø§Ø¦ÙŠØ© = ØªØ¹Ù„ÙŠÙ‚"),
    (1508, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø§Ø­Ø¯ ÙŠØ¹Ø±Ù Ø§ÙˆÙ‚Ø§Øª Ù…Ù‚Ø¯Ù…Ø© ÙÙŠ Ø§Ù„Ù…Ù‡Ø§Ø±Ø§Øª Ø§Ù„Ø§ÙƒÙ„ÙŠÙ†ÙŠÙƒÙŠØ© = Ø³Ø¤Ø§Ù„"),
    (1486, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ù…Ø¯Ø±ÙŠ Ø§Ø°Ø§ Ù†Ø²Ù„ Ø¨ÙŠÙ‚ÙˆÙ„Ùˆ Ù‡ÙˆÙ†ÙŠÙƒ Ø¨Ø§Ù„Ø§Ø±Ø´ÙŠÙ = ØªØ¹Ù„ÙŠÙ‚ Ø¹Ø§Ø¯ÙŠ"),
    (1519, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø°ÙŠ ØªØ±Ø³Ù„ Ù„Ù‡ Ù…Ø´Ø¨ÙˆÙ‡ ÙÙŠÙ‡ = ØªØ­Ø°ÙŠØ± ØªÙˆØ¹ÙˆÙŠ"),
    (1623, "Ø·Ø¨ÙŠØ¹ÙŠ", ["Ø·Ø¨ÙŠØ¹ÙŠ"],
     "ÙˆØ§Ø­Ù†Ø§ Ø§Ù„Ù„ÙŠ Ø¨Ù†Ù„Ø¨Ø³ ÙÙŠ Ø§Ù„Ø¢Ø®Ø± ÙÙŠ ØªØ­ÙˆÙŠÙ„Ø§ØªÙ‡Ù… Ø§Ù„Ù…Ø´Ø¨ÙˆÙ‡ = Ø´ÙƒÙˆÙ‰"),

    # ========================================================
    # ACADEMIC â†’ MEDICAL (medical services listed first)
    # ========================================================
    (464, "Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø¹Ø±Ø¶)", ["Ø§Ø­ØªÙŠØ§Ù„ Ø·Ø¨ÙŠ (Ø¹Ø±Ø¶)", "ØºØ´ Ø£ÙƒØ§Ø¯ÙŠÙ…ÙŠ (Ø¹Ø±Ø¶)"],
     "Ø§Ù„Ø¯ÙƒØªÙˆØ±Ø© Ø±ÙŠÙ…: Ø§Ø¹Ø°Ø§Ø± Ø·Ø¨ÙŠØ© Ø³ÙƒØ§Ù„ÙŠÙ + ÙˆØ§Ø¬Ø¨Ø§Øª = Ø·Ø¨ÙŠ Ø£ÙˆÙ„Ø§Ù‹"),

    # ========================================================
    # Academic Cheating that is actually spam (design services)
    # ========================================================
    (228, "Ø³Ø¨Ø§Ù…", ["Ø³Ø¨Ø§Ù…"],
     "ZN Design ØªØµÙ…ÙŠÙ… Ø¨ÙˆØ³ØªØ±Ø§Øª ÙˆØ¨Ø§Ù†Ø±Ø§Øª ÙˆÙ…Ù†ÙŠÙˆ = Ø®Ø¯Ù…Ø§Øª ØªØµÙ…ÙŠÙ…"),
]


def main():
    print("=" * 60)
    print("ðŸ”§ Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ø¹ÙŠÙ†Ø§Øª - Ø§Ù„Ø¬ÙˆÙ„Ø© Ø§Ù„Ø±Ø§Ø¨Ø¹Ø©")
    print("=" * 60)

    with open(DATA_PATH, "r", encoding="utf-8") as f:
        data = json.load(f)

    print(f"ðŸ“Š Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¹ÙŠÙ†Ø§Øª: {len(data)}")

    os.makedirs(BACKUP_DIR, exist_ok=True)
    ts = datetime.now().strftime("%Y%m%d_%H%M%S")
    backup_path = os.path.join(BACKUP_DIR, f"training_data_pre_fix_r4_{ts}.json")
    shutil.copy2(DATA_PATH, backup_path)
    print(f"ðŸ’¾ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©: {backup_path}")

    print("\nðŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ù‚Ø¨Ù„:")
    before = Counter(d["label"] for d in data)
    for k, v in before.most_common():
        print(f"  {k}: {v}")

    print(f"\nðŸ”§ ØªØ·Ø¨ÙŠÙ‚ {len(FIXES)} Ø¥ØµÙ„Ø§Ø­...")
    print("-" * 60)

    fix_count = 0
    skipped = 0
    for idx, new_label, new_labels, reason in FIXES:
        if idx >= len(data):
            continue
        sample = data[idx]
        old_label = sample.get("label", "")
        if old_label == new_label and sample.get("labels", []) == new_labels:
            skipped += 1
            continue

        sample["label"] = new_label
        sample["labels"] = new_labels
        sample["note"] = f"Fix R4: {old_label} -> {new_label} ({reason})"
        sample["reviewed_at"] = datetime.now().isoformat()
        sample["reviewed_by"] = "full_audit_r4_feb2026"

        fix_count += 1
        text_preview = sample["text"][:50].replace('\n', ' ')
        print(f"  âœ… [{idx}] {old_label} -> {new_label}")
        print(f"       {text_preview}...")

    if skipped:
        print(f"\n  â­ï¸  ØªØ®Ø·ÙŠ {skipped}")

    with open(DATA_PATH, "w", encoding="utf-8") as f:
        json.dump(data, f, ensure_ascii=False, indent=2)

    print(f"\nðŸ“Š Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø¨Ø¹Ø¯:")
    after = Counter(d["label"] for d in data)
    for k, v in after.most_common():
        diff = v - before.get(k, 0)
        marker = f" ({'+' if diff > 0 else ''}{diff})" if diff != 0 else ""
        print(f"  {k}: {v}{marker}")

    print(f"\nâœ… ØªÙ… Ø¥ØµÙ„Ø§Ø­ {fix_count} Ø¹ÙŠÙ†Ø© (Ù…Ù† {len(FIXES)} Ù…Ø·Ù„ÙˆØ¨Ø©)")


if __name__ == "__main__":
    main()
